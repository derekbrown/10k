!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports,require("react"),require("swr")):"function"==typeof define&&define.amd?define(["exports","react","swr"],r):r((e||self).useNft={},e.react,e.swr)}(this,function(e,r,t){function n(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var o=/*#__PURE__*/n(r),i=/*#__PURE__*/n(t);function a(){return a=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},a.apply(this,arguments)}function u(e){return u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},u(e)}function c(e,r){return c=Object.setPrototypeOf||function(e,r){return e.__proto__=r,e},c(e,r)}function s(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function l(e,r,t){return l=s()?Reflect.construct:function(e,r,t){var n=[null];n.push.apply(n,r);var o=new(Function.bind.apply(e,n));return t&&c(o,t.prototype),o},l.apply(null,arguments)}function f(e){var r="function"==typeof Map?new Map:void 0;return f=function(e){if(null===e||-1===Function.toString.call(e).indexOf("[native code]"))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==r){if(r.has(e))return r.get(e);r.set(e,t)}function t(){return l(e,arguments,u(this).constructor)}return t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),c(t,e)},f(e)}function d(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var h=/^https:\/\/rarible\.com\/token\/(0x[a-fA-F0-9]{40}):([0-9]+)/;function m(e){return/^0x[a-fA-F0-9]{40}$/.test(e)}function p(e){return e}function v(e,r){return void 0===r&&(r=""),"https://ipfs.io/ipfs/"+e+r}var g=/^ipfs:\/\/(?:ipfs\/)?([^/]+)(\/.+)?$/,y=/^Qm[1-9A-HJ-NP-Za-km-z]{44}$/;function w(e,r){var t=g.exec(e);if(t){var n=t[2];return r(t[1],void 0===n?"":n)}return y.test(e)?r(e):e}function P(e,r,t){return e=function(e,r){try{var t=new URL(e);return"api.opensea.io"!==t.host&&"testnets-api.opensea.io"!==t.host||!t.pathname.includes("0x%7Bid%7D")?e:(t.pathname=t.pathname.replace(/0x%7Bid%7D/g,r),t.searchParams.set("format","json"),String(t))}catch(r){return e}}(e,r),(e=w(e=function(e){try{var r=new URL(e);return"api.niftygateway.com"!==r.host?e:(r.pathname=r.pathname+"/",String(r))}catch(r){return e}}(e),t.ipfsUrl)).startsWith("http")&&(e=t.jsonProxy(e)),e}function b(e,r){return w(e,r.ipfsUrl)}function x(e,r){return(null==e?void 0:e.toLowerCase())===(null==r?void 0:r.toLowerCase())}function j(e){return I(Promise.all([].concat(e).map(I)))}function I(e){return new Promise(function(r,t){Promise.resolve(e).then(t,r)})}var k=/*#__PURE__*/function(e){var r,t;function n(r,t){var n;return(n=e.call(this,r)||this).errors=void 0,n.name="MultipleErrors",n.errors=t,n}return t=e,(r=n).prototype=Object.create(t.prototype),r.prototype.constructor=r,c(r,t),n}(/*#__PURE__*/f(Error)),A=/\.(?:png|svg|jpg|jepg|gif|webp|jxl|avif)$/,E=/\.(?:mp4|mov|webm|ogv)$/;function O(e){return A.test(e)?"image":E.test(e)?"video":"unknown"}var T="0x959e104E1a4dB6317fA58F8295F586e1A978c297",U="0xf87e31492faf9a91b02ee0deaad50d51d56d5d4d",N=function(e,r){try{return Promise.resolve(r(e,C)).then(function(r){return{description:F,image:(t=r,o=t.indexOf(",")+1,null!=(n=t.slice(0,o)+encodeURIComponent(t.slice(o)))?n:""),imageType:"image",metadataUrl:"",name:"CryptoPunk "+e,owner:"",rawData:null};var t,n,o})}catch(e){return Promise.reject(e)}},F='\n  10,000 unique collectible characters with proof of ownership stored on the\n  Ethereum blockchain. The project that inspired the modern CryptoArt movement.\n  The first "Non-Fungible Token," and inspiration for the Ethereum ERC-721\n  standard that powers most digital art and collectibles.\n',C={address:"0x16F5A35647D6F03D5D3da7b35409D65ba03aF3B2",methodName:"punkImageSvg",methodHash:"0x74beb047",humanReadableAbi:["function punkImageSvg(uint16 index) view returns (string svg)"]};function D(e){return x(e,"0xb47e3cd837ddf8e4c57f05d70ab865de6e193bbb")}var S=function(e,r){var t=r.jsonProxy;try{var n=t("https://api.cryptokitties.co/v3/kitties/"+e);return Promise.resolve(fetch(n)).then(function(e){return Promise.resolve(e.json()).then(function(e){var r,t,o,i=null!=(r=null==e?void 0:e.image_url)?r:"";return{description:null!=(t=null==e?void 0:e.bio)?t:"−",image:i,imageType:i?"image":"unknown",metadataUrl:n,name:null!=(o=null==e?void 0:e.name)?o:"Unknown",owner:"",rawData:e}})})}catch(e){return Promise.reject(e)}};function B(e){return x(e,"0x06012c8cf97BEaD5deAe237070F9587f8E7A266d")}var R=function(e){try{return Promise.resolve(fetch(_,{body:M(T,e),method:"POST"})).then(function(e){return Promise.resolve(e.json()).then(function(e){var r,t,n,o,i,a,u,c,s=e.data,l=null==s||null==(r=s.nfts)?void 0:r[0],f=null!=(t=null==l?void 0:l.image)?t:"";return{description:null!=(n=null==l||null==(o=l.estate)||null==(i=o.data)?void 0:i.description)?n:"−",image:f,imageType:f?"image":"unknown",metadataUrl:"",name:null!=(a=null==l?void 0:l.name)?a:"Unknown",owner:null!=(u=null==l||null==(c=l.owner)?void 0:c.address)?u:"",rawData:s}})})}catch(e){return Promise.reject(e)}},_="https://api.thegraph.com/subgraphs/name/decentraland/marketplace";function M(e,r){return JSON.stringify({operationName:"NFTByTokenId",variables:{contractAddress:e,tokenId:r},query:"\n  query NFTByTokenId($contractAddress: String, $tokenId: String) {\n    nfts(\n      where: { contractAddress: $contractAddress, tokenId: $tokenId }\n      first: 1\n    ) {\n      name\n      image\n      owner {\n        address\n      }\n      estate {\n        size\n        data {\n          description\n        }\n      }\n    }\n  }\n"})}function $(e){return x(e,T)}var q=function(e){try{return Promise.resolve(fetch(W,{body:z(U,e),method:"POST"})).then(function(e){return Promise.resolve(e.json()).then(function(e){var r,t,n,o,i,a,u,c=e.data,s=null==c||null==(r=c.nfts)?void 0:r[0],l=null==s?void 0:s.parcel,f=null!=(t=null==s?void 0:s.image)?t:"";return{description:null!=(n=null==l||null==(o=l.data)?void 0:o.description)?n:"-",image:f,imageType:f?"image":"unknown",metadataUrl:"",name:null!=(i=null==s?void 0:s.name)?i:"Parcel "+(null==l?void 0:l.x)+","+(null==l?void 0:l.y),owner:null!=(a=null==s||null==(u=s.owner)?void 0:u.address)?a:"",rawData:c}})})}catch(e){return Promise.reject(e)}},W="https://api.thegraph.com/subgraphs/name/decentraland/marketplace";function z(e,r){return JSON.stringify({operationName:"NFTByTokenId",variables:{contractAddress:e,tokenId:r},query:"\n  query NFTByTokenId($contractAddress: String, $tokenId: String) {\n    nfts(\n      where: { contractAddress: $contractAddress, tokenId: $tokenId }\n      first: 1\n    ) {\n      name\n      image\n      owner {\n        address\n      }\n      parcel {\n        x\n        y\n        data {\n          description\n        }\n      }\n    }\n  }\n"})}function H(e){return x(e,U)}var L=function(e,r,t){try{return Promise.resolve(r(e,Q)).then(function(r){return Promise.resolve(J(r,t.ipfsUrl)).then(function(t){return{description:"The (unofficial) wrapped version of MoonCats Rescue. Original cat ID: "+r+".",image:t,imageType:t?"image":"unknown",metadataUrl:"",name:"Wrapped MoonCat #"+e,owner:"",rawData:null}})})}catch(e){return Promise.reject(e)}},J=function(e,r){try{var t=e.slice(4,6),n=w("ipfs://ipfs/"+Z+"/"+t+"/"+e+".png",r);return Promise.resolve((o=n,new Promise(function(e,r){var t=new Image;t.src=o,t.crossOrigin="",t.onload=function(){return e(t)},t.onerror=function(e){return r(e)}}))).then(function(e){return function(e,r){var t=void 0===r?{}:r,n=t.scale,o=void 0===n?1:n,i=t.padding,a=void 0===i?0:i,u=e.naturalWidth*o,c=e.naturalHeight*o,s=Math.max(u*a,c*a),l=document.createElement("canvas");l.width=u+2*s,l.height=c+2*s;var f=l.getContext("2d");return null===f?null:(f.imageSmoothingEnabled=!1,f.drawImage(e,s,s,u,c),l.toDataURL())}(e,{scale:4,padding:.125})})}catch(e){return Promise.reject(e)}var o},Q={address:"0x7c40c393dc0f283f318791d746d894ddd3693572",methodName:"_tokenIDToCatID",methodHash:"0xfe294644",humanReadableAbi:["function _tokenIDToCatID(uint256 tokenId) view returns (bytes5 catId)"]},Z="bafybeidk4zunuq56w2pf2sncexohlyqae62dzplljkbwswa7jwywh2dava";function G(e){return x(e,Q.address)}var K=function(e,r){try{return Promise.resolve(fetch(e)).then(function(t){function n(){var e=a({},o);if(function(e){var r,t,n,o,i,a,u,c,s,l,f,d;return!(!e||"object"!=typeof e)&&"Asset Metadata"===e.title&&"object"===e.type&&"string"==typeof(null==(r=e.properties)||null==(t=r.name)?void 0:t.description)&&"string"==typeof(null==(n=e.properties)||null==(o=n.image)?void 0:o.description)&&"string"==typeof(null==(i=e.properties)||null==(a=i.description)?void 0:a.description)&&"string"===(null==(u=e.properties)||null==(c=u.name)?void 0:c.type)&&"string"===(null==(s=e.properties)||null==(l=s.image)?void 0:l.type)&&"string"===(null==(f=e.properties)||null==(d=f.description)?void 0:d.type)}(e)&&(e=function(e){var r,t,n,o,i,u;return{name:(null==(r=e.properties)||null==(t=r.name)?void 0:t.description)||"",description:(null==(n=e.properties)||null==(o=n.description)?void 0:o.description)||"",image:(null==(i=e.properties)||null==(u=i.image)?void 0:u.description)||"",rawData:a({},e)}}(e)),!function(e){return!(!e||"object"!=typeof e)&&("name"in e||"image"in e)}(e=function(e){return e&&"object"==typeof e&&void 0===(null==e?void 0:e.image)&&"string"==typeof(null==e?void 0:e.imageUrl)?a({},e,{image:null==e?void 0:e.imageUrl}):e}(e)))throw new Error("Invalid data received");return function(e,r){return a({},e,{image:b(e.image,r)})}({description:e.description||"",image:e.image||"",name:e.name||"",rawData:o},r)}if(!t.ok)throw new Error("Error when trying to request "+e);var o,i=function(e,r){try{var n=Promise.resolve(t.json()).then(function(e){o=e})}catch(e){return r()}return n&&n.then?n.then(void 0,r):n}(0,function(){o={name:"",description:"",image:e}});return i&&i.then?i.then(n):n()})}catch(e){return Promise.reject(e)}},V=function(e,r,t){try{return Promise.resolve(j([e.tokenURI(r),e.uri(r)]).catch(function(e){throw new k("An error occurred while trying to fetch the token URI from the NFT contract. See the “errors” property on this error for details.",e)})).then(function(e){return P(e,r,t)})}catch(e){return Promise.reject(e)}},X=["function tokenURI(uint256 _tokenId) external view returns (string)","function ownerOf(uint256 _tokenId) external view returns (address)","function uri(uint256 _id) external view returns (string)"];function Y(e){return{config:e,fetchNft:function(r,t,n){try{if(!m(r))throw new Error("Invalid contract address: "+r);return Promise.resolve(function(e,r,t,n){try{return H(e)?Promise.resolve(q(r)):$(e)?Promise.resolve(R(r)):B(e)?Promise.resolve(S(r,n)):Promise.resolve(function(e){try{var r;return null!=(r=e.ethers)&&r.Contract?Promise.resolve(e):Promise.resolve(function(r,t){try{var n=Promise.resolve(import("@ethersproject/contracts")).then(function(r){if(null==r||!r.Contract)throw new Error;return a({},e,{ethers:r})})}catch(e){return t()}return n&&n.then?n.then(void 0,t):n}(0,function(){throw new Error("Ethers couldn’t be imported. Please add the ethers module to your project dependencies, or inject it in the Ethers fetcher options.")}))}catch(e){return Promise.reject(e)}}(t)).then(function(t){return D(e)?N(r,function(e){return function(r,t){try{var n=new e.ethers.Contract(t.address,t.humanReadableAbi,e.provider);return Promise.resolve(n.punkImageSvg(r))}catch(e){return Promise.reject(e)}}}(t)):G(e)?L(r,function(e){return function(r,t){try{var n=new e.ethers.Contract(t.address,t.humanReadableAbi,e.provider);return Promise.resolve(n._tokenIDToCatID(r)).then(function(e){return null!=e?e:""})}catch(e){return Promise.reject(e)}}}(t),n):function(e,r,t,n){try{var o=new t.ethers.Contract(e,X,t.provider);return Promise.resolve(Promise.all([V(o,r,n),o.ownerOf(r).catch(function(){return""})])).then(function(e){var r=e[0],t=e[1];return Promise.resolve(K(r,n)).then(function(e){return a({},e,{imageType:O(e.image),metadataUrl:r,owner:t})})})}catch(e){return Promise.reject(e)}}(e,r,t,n)})}catch(e){return Promise.reject(e)}}(r,t,e,n)).then(function(e){return function(e,r){return e.image.startsWith("http")?a({},e,{image:r(e.image,e)}):e}(e,n.imageProxy)})}catch(e){return Promise.reject(e)}}}}function ee(e){for(var r="",t=0;t<32;++t)r+=("0"+(e>>BigInt(256-8*t-8)&BigInt(255)).toString(16)).slice(-2);return r}function re(e){for(var r,t=BigInt(0),n=function(e,r){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(t)return(t=t.call(e)).next.bind(t);if(Array.isArray(e)||(t=function(e,r){if(e){if("string"==typeof e)return d(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?d(e,r):void 0}}(e))){t&&(e=t);var n=0;return function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(e);!(r=n()).done;){var o=r.value;t=(t<<BigInt(8))+BigInt(o)}return t}function te(e){var r;return e=e.replace(/^0x/,""),new Uint8Array((null!=(r=e.match(/.{1,2}/g))?r:[]).map(function(e){return parseInt(e,16)}))}function ne(e){var r=te(e),t=Number(re(r.subarray(0,32))),n=Number(re(r.subarray(t,t+32))),o=r.subarray(t+32,t+32+n);return(new TextDecoder).decode(o)}function oe(e){var r=re(te(e).subarray(0,32));if(r>=Math.pow(BigInt(2),BigInt(160)))throw new Error("Encoded value is bigger than the largest possible address.  Decoded value: 0x"+r.toString(16)+".");return"0x"+r.toString(16)}function ie(e){return"0xc87b56dd"+ee(e)}function ae(e){return"0x6352211e"+ee(e)}function ue(e,r,t){return e.request({method:"eth_call",params:[{data:t,to:r},"latest"]})}var ce=function(e,r,t,n){try{return Promise.resolve(j(function(e){return[ie(BigInt(e)),(r=BigInt(e),"0x0e89341c"+ee(r))];var r}(r).map(function(r){return ue(t,e,r)})).catch(function(e){throw new k("An error occurred while trying to fetch the token URI from the NFT contract. See the “errors” property on this error for details.",e)})).then(function(e){return P(ne(e),r,n)})}catch(e){return Promise.reject(e)}};function se(e){var r=function(e){if(!e.ethereum){if(!window.ethereum)throw new Error("Missing ethereum provider.");e.ethereum=window.ethereum}return e}(e);return{config:r,fetchNft:function(e,t,n){try{if(!m(e))throw new Error("Invalid contract address: "+e);return Promise.resolve(function(e,r,t,n){try{return H(e)?Promise.resolve(q(r)):$(e)?Promise.resolve(R(r)):B(e)?Promise.resolve(S(r,n)):D(e)?Promise.resolve(N(r,function(e){return function(r,t){try{if(void 0===e.ethereum)throw new Error("No Ethereum provider");return Promise.resolve(ue(e.ethereum,t.address,t.methodHash+ee(BigInt(r))).then(ne))}catch(e){return Promise.reject(e)}}}(t))):G(e)?Promise.resolve(L(r,function(e){return function(r,t){try{if(void 0===e.ethereum)throw new Error("No Ethereum provider");return Promise.resolve(ue(e.ethereum,t.address,t.methodHash+ee(BigInt(r)))).then(function(e){return e.slice(0,12)})}catch(e){return Promise.reject(e)}}}(t),n)):Promise.resolve(function(e,r,t,n){var o=t.ethereum;try{return Promise.resolve(Promise.all([ce(e,r,o,n),ue(o,e,ae(BigInt(r))).then(oe).catch(function(){return""})])).then(function(e){var r=e[0],t=e[1];return Promise.resolve(K(r,n)).then(function(e){return a({},e,{imageType:O(e.image),metadataUrl:r,owner:t})})})}catch(e){return Promise.reject(e)}}(e,r,t,n))}catch(e){return Promise.reject(e)}}(e,t,r,n)).then(function(e){return function(e,r){return e.image.startsWith("http")?a({},e,{image:r(e.image,e)}):e}(e,n.imageProxy)})}catch(e){return Promise.reject(e)}}}}var le={name:"",description:"",image:""};function fe(e){return function(e){return Array.isArray(e)&&2==e.length&&"ethers"===e[0]}(e)?Y(e[1]):function(e){return Array.isArray(e)&&2==e.length&&"ethereum"===e[0]}(e)?se(e[1]):e}var de=r.createContext(null),he={name:"",description:"",image:""};e.FetchWrapper=/*#__PURE__*/function(){function e(e,r){void 0===r&&(r={}),this.fetcher=void 0,this.fetchContext=void 0,this.fetcher=this.normalizeFetcher(e),this.fetchContext=this.fetchContextFromOptions(r)}var r=e.prototype;return r.fetchContextFromOptions=function(e){var r=e.imageProxy,t=e.ipfsUrl,n=e.jsonProxy;return{imageProxy:null!=r?r:p,ipfsUrl:null!=t?t:v,jsonProxy:null!=n?n:p}},r.normalizeFetcher=function(e){return e?this.isFetcherDeclarationEthers(e)?Y(e[1]):this.isFetcherDeclarationEthereum(e)?se(e[1]):e:{config:{},fetchNft:function(){return Promise.resolve(he)}}},r.isFetcherDeclarationEthers=function(e){return Array.isArray(e)&&2==e.length&&"ethers"===e[0]},r.isFetcherDeclarationEthereum=function(e){return Array.isArray(e)&&2==e.length&&"ethereum"===e[0]},r.fetchNft=function(e,r){try{return Promise.resolve(this.fetcher.fetchNft(e,r,this.fetchContext))}catch(e){return Promise.reject(e)}},e}(),e.NftProvider=function(e){var r=e.children,n=e.fetcher,i=e.imageProxy,a=void 0===i?p:i,u=e.ipfsUrl,c=void 0===u?v:u,s=e.jsonProxy,l=void 0===s?p:s;if(!n)throw new Error("Please set the fetcher prop on <NftProvider />");var f={fetcher:fe(n),imageProxy:a,ipfsUrl:c,jsonProxy:l};return o.default.createElement(t.SWRConfig,{value:{provider:function(){return new Map}}},o.default.createElement(de.Provider,{value:f},r))},e.ethereumFetcher=se,e.ethersFetcher=Y,e.parseNftUrl=function(e){var r=h.exec(e);return r?[r[1],r[2]]:null},e.useNft=function(e,n){var o,u=r.useContext(de);if(null===u)throw new Error("Please wrap your app with <NftProvider />");var c=u.fetcher,s=u.imageProxy,l=u.ipfsUrl,f=u.jsonProxy,d=r.useMemo(function(){return{imageProxy:s,ipfsUrl:l,jsonProxy:f}},[s,l,f]),h=r.useCallback(function(){return c?c.fetchNft(e,n,d):a({},le)},[e,c,d,n]),m=null!=(o=t.useSWRConfig().cache.get(e+n))&&o,p=i.default(e+n,h,{revalidateOnMount:!m,revalidateOnFocus:!1,revalidateOnReconnect:!1});return r.useMemo(function(){var e=p.error,r=p.data,t=p.mutate,n=function(){return t().then(function(){return!0}).catch(function(){return!1})};return void 0===e&&void 0===r?{error:void 0,loading:!0,nft:void 0,reload:n,status:"loading"}:void 0!==e?{error:e,loading:!1,nft:void 0,reload:n,status:"error"}:{error:void 0,loading:!1,nft:r,reload:n,status:"done"}},[p])}});
//# sourceMappingURL=use-nft.umd.js.map
